{"version":3,"file":"index.umd.js","sources":["../src/config.js","../src/i18n/en.js","../src/view.js","../src/validator.js","../src/element.js","../src/form.js","../src/utils.js","../src/index.js"],"sourcesContent":["const validators = {}\nconst configurations = {\n  debounceMs: 175,\n  focusOnError: true,\n  disableSubmitButtons: false,\n  containerSelector: \"[data-field-container]\",\n  errorMessageClass: \"error-message\",\n  errorMessagePosition: \"end\",\n  containerErrorClass: \"container-error\",\n  fieldErrorClass: \"field-error\",\n}\n\nconst locals = {}\n\nconst validationMap = {\n  badInput: \"invalid\",\n  patternMismatch: \"pattern\",\n  rangeOverflow: \"max\",\n  rangeUnderflow: \"min\",\n  stepMismatch: \"step\",\n  tooLong: \"maxLength\",\n  tooShort: \"minLength\",\n  typeMismatch: \"typeMismatch\",\n  valueMissing: \"required\",\n}\n\nconst config = (options = {}) => {\n  Object.assign(configurations, options)\n}\n\nconst addValidator = (name, func) => {\n  validators[name] = func\n}\n\nconst addLocal = (name, transalation) => {\n  const result = {}\n  Object.keys(validationMap).forEach((validationClass) => {\n    const validationName = validationMap[validationClass]\n    result[validationClass] = transalation[validationName]\n  })\n\n  locals[name] = result\n}\n\nexport default class {\n  constructor(dataMap) {\n    this.locals = Object.assign({}, locals)\n    this.validators = Object.assign({}, validators)\n    this.configurations = Object.assign({}, configurations)\n\n    Object.keys(this.configurations).forEach((key) => {\n      if (dataMap.has(key)) {\n        this.configurations[key] = dataMap.get(key)\n      }\n      this.configurations.debounceMs = parseInt(this.configurations.debounceMs)\n\n      this.configurations.focusOnError =\n        this.configurations.focusOnError === true ||\n        this.configurations.focusOnError === \"true\"\n    })\n  }\n\n  get currentLocal() {\n    return this.locals[\"en\"]\n  }\n}\nexport { addValidator, config, addLocal }\n","import { addLocal } from \"../config\"\n\nconst transalation = {\n  invalid: \"is invalid\",\n  pattern: \"value doesn't match %{pattern}\",\n  max: \"value must be less than %{max}\",\n  min: \"value must be greater than %{min}\",\n  step: \"number is not divisible by %{step}\",\n  maxLength: \"too long (maximum is %{maxLength} characters)\",\n  minLength: \"too short (minimum is %{minLength} characters)\",\n  typeMismatch: \"not a valid %{type}\",\n  required: \"can't be blank\",\n}\n\naddLocal(\"en\", transalation)\n","export default class {\n  constructor(config) {\n    this.config = config\n  }\n\n  displayError(el, errorMessage) {\n    this._insertErrorMessageElement(el)\n\n    this.errorElement(el).textContent = errorMessage\n    this.container(el).classList.add(this.config.containerErrorClass)\n    el.classList.add(this.config.fieldErrorClass)\n    el.dataset.errorDisplayed = true\n  }\n\n  reset(el) {\n    this.container(el).classList.remove(this.config.containerErrorClass)\n    el.classList.remove(this.config.fieldErrorClass)\n    const errorElement = this.errorElement(el)\n\n    errorElement && errorElement.remove()\n  }\n\n  displaySuccess(el) {\n    this.reset(el)\n  }\n\n  // private\n\n  _insertErrorMessageElement(el) {\n    if (this.errorElement(el)) return\n\n    this.container(el).insertAdjacentHTML(\n      this.errorMessagePosition,\n      `<div class=\"${this.config.errorMessageClass}\"></div>`\n    )\n  }\n\n  errorElement(el) {\n    return this.container(el).querySelector(\".\" + this.config.errorMessageClass)\n  }\n\n  container(el) {\n    const _container = el.closest(this.config.containerSelector)\n\n    if (!_container) {\n      throw new Error(\n        `We couldn't find the container for ${el} with selector ${this.config.containerErrorClass}`\n      )\n    }\n\n    return _container\n  }\n\n  get errorMessagePosition() {\n    switch (this.config.errorMessagePosition) {\n      case \"end\":\n        return \"beforeend\"\n      case \"start\":\n        return \"afterbegin\"\n\n      default:\n        return \"beforeend\"\n    }\n  }\n}\n","const customMessageAttribute = {\n  badInput: \"is invalid\",\n  patternMismatch: \"patternMessage\",\n  rangeOverflow: \"maxMessage\",\n  rangeUnderflow: \"minMessage\",\n  stepMismatch: \"stepMessage\",\n  tooLong: \"maxLengthMessage\",\n  tooShort: \"minLengthMessage\",\n  typeMismatch: \"typeMessage\",\n  valueMissing: \"requiredMessage\",\n}\n\nexport class ValidationError extends Error {\n  constructor(message) {\n    super(message)\n    this.name = this.constructor.name\n  }\n}\n\nexport default class {\n  constructor(el, config) {\n    this.el = el\n    this.errorType = this.errorType()\n    this.config = config\n  }\n\n  message() {\n    return new Promise(async (resolve, reject) => {\n      const fieldValid = this.el.validity.valid\n\n      if (!fieldValid) {\n        reject(\n          new ValidationError(this.customMessage() || this.defaultMessage())\n        )\n\n        return\n      }\n\n      try {\n        resolve(await this.customValidationMessage())\n      } catch (error) {\n        if (typeof error === \"string\") {\n          reject(new ValidationError(error))\n        } else {\n          throw error\n        }\n      }\n    })\n  }\n\n  // private\n\n  customMessage() {\n    const dataAttribute = customMessageAttribute[this.errorType]\n\n    return this.el.dataset[dataAttribute]\n  }\n\n  errorType() {\n    const errorTypes = [\n      \"badInput\",\n      \"patternMismatch\",\n      \"rangeOverflow\",\n      \"rangeUnderflow\",\n      \"stepMismatch\",\n      \"tooLong\",\n      \"tooShort\",\n      \"typeMismatch\",\n      \"valueMissing\",\n    ]\n    for (let index = 0; index < errorTypes.length; index++) {\n      if (this.el.validity[errorTypes[index]]) {\n        return errorTypes[index]\n      }\n    }\n  }\n\n  customValidationMessage() {\n    const customValidations = this.el.dataset.validates\n    // scrub text\n    if (!customValidations) return\n\n    return Promise.all(\n      customValidations.split(/\\s+/).map((validationMethod) => {\n        const method = this.config.validators[validationMethod]\n\n        if (!method) {\n          throw new Error(\n            `Custom validation ${validationMethod} is not defined`\n          )\n        }\n\n        return method(this.el)\n      })\n    )\n  }\n\n  defaultMessage() {\n    const message = this.config.currentLocal[this.errorType]\n\n    return (\n      message &&\n      message.replace(/\\%\\{(.*)}/, (_, match) => {\n        return this.el[match]\n      })\n    )\n  }\n}\n","import Validator from \"./validator\"\nimport { ValidationError } from \"./validator\"\nconst validInputTypes = [\n  \"checkbox\",\n  \"color\",\n  \"date\",\n  \"datetime-local\",\n  \"email\",\n  \"file\",\n  \"month\",\n  \"number\",\n  \"password\",\n  \"radio\",\n  \"range\",\n  \"search\",\n  \"tel\",\n  \"text\",\n  \"time\",\n  \"url\",\n  \"week\",\n]\n\nexport default class {\n  constructor(node, config) {\n    this.raw = node\n    this.config = config\n  }\n\n  isInvalid() {\n    return this.hasCacheErrorMessage()\n  }\n\n  isValid() {\n    return !this.isInvalid()\n  }\n\n  validate() {\n    return new Promise(async (resolve, reject) => {\n      try {\n        await this._errorMessage()\n        this.removeCachedErrorMessage()\n\n        resolve()\n      } catch (error) {\n        if (error instanceof ValidationError) {\n          this.cacheErrorMessage(error.message)\n          reject(error)\n        } else {\n          throw error\n        }\n      }\n    })\n  }\n\n  set visited(bool) {\n    this.raw.dataset.visited = bool\n  }\n\n  get visited() {\n    if (this.raw.dataset.visited) return true\n    const nodeName = this.raw.nodeName.toLowerCase()\n\n    if (nodeName === \"input\") {\n      return ![\"text\", \"email\", \"password\", \"search\", \"tel\", \"url\"].includes(\n        this.raw.type\n      )\n    } else if (nodeName === \"textarea\") {\n      return false\n    } else {\n      return true\n    }\n  }\n\n  get willValidate() {\n    if (this.raw.dataset.validationOn) return true\n    if (this.raw.dataset.validationOff) return false\n\n    const elementName = this.raw.nodeName.toLowerCase()\n\n    const validatable =\n      elementName === \"input\" && validInputTypes.includes(this.raw.type)\n    if (validatable || [\"select\", \"textarea\"].includes(elementName)) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  cacheErrorMessage(message) {\n    this.raw.dataset.validationMessageCache = message\n  }\n\n  get cachedErrorMessage() {\n    return this.raw.dataset.validationMessageCache\n  }\n\n  removeCachedErrorMessage() {\n    this.raw.removeAttribute(\"data-validation-message-cache\")\n  }\n\n  hasCacheErrorMessage() {\n    return this.raw.hasAttribute(\"data-validation-message-cache\")\n  }\n\n  _errorMessage() {\n    return new Validator(this.raw, this.config).message()\n  }\n}\n","import Element from \"./element\"\nimport { ValidationError } from \"./validator\"\n\nexport default class Form {\n  constructor(node, config) {\n    this.raw = node\n    this.config = config\n  }\n\n  get elements() {\n    return this._allElements\n      .map((el) => new Element(el, this.config))\n      .filter((el) => el.willValidate)\n  }\n\n  get submitButtons() {\n    return this._allElements.filter((el) => el.type === \"submit\")\n  }\n\n  get elementsWithError() {\n    return this.elements.filter((el) => el.isInvalid())\n  }\n\n  isInvalid() {\n    return this.elements.some((el) => el.isInvalid())\n  }\n\n  isValid() {\n    return !this.isInvalid()\n  }\n\n  markAllAsVisited() {\n    this.elements.forEach((el) => (el.visited = true))\n  }\n\n  validate() {\n    let valid = true\n    return new Promise((resolve, reject) => {\n      const elements = this.elements\n\n      if (!elements.length) resolve()\n\n      elements.forEach(async (el, index) => {\n        try {\n          await el.validate()\n        } catch (error) {\n          if (error instanceof ValidationError) {\n            valid = false\n          } else {\n            throw error\n          }\n        }\n\n        if (index + 1 === elements.length) {\n          valid ? resolve() : reject(new ValidationError(\"form invalid\"))\n        }\n      })\n    })\n  }\n\n  // private\n\n  get _allElements() {\n    return Array.from(this.raw.elements)\n  }\n}\n","export const debounced = (fn, wait) => {\n  let timeoutId\n  let target\n\n  return (e) => {\n    clearTimeout(timeoutId)\n\n    if (e.target !== target) {\n      return fn(e)\n    }\n\n    timeoutId = setTimeout(() => {\n      timeoutId = null\n      fn(e)\n    }, wait)\n  }\n}\n","import \"./i18n/en\"\nimport View from \"./view\"\nimport Form from \"./form\"\nimport Element from \"./element\"\nimport { ValidationError } from \"./validator\"\nimport Config from \"./config\"\nimport { debounced } from \"./utils\"\nimport { Controller } from \"@hotwired/stimulus\"\n\nclass ValidationController extends Controller {\n  connect = () => this._setup()\n  disconnect = () => this._removeEventListeners()\n\n  display({ target, errorMessage, previousMessage, visited }) {\n    if (errorMessage === previousMessage && target.dataset.errorDisplayed) {\n      return\n    }\n\n    if (errorMessage) {\n      if (visited) {\n        this._view.displayError(target, errorMessage)\n      }\n    } else {\n      this._view.reset(target)\n    }\n  }\n\n  recordVisit = (e) => {\n    const el = new Element(e.target, this.config)\n\n    if (!el.willValidate) return\n    el.visited = true\n\n    this._validate(e)\n  }\n\n  // private\n\n  _setup() {\n    this.form.noValidate = true\n\n    this.config = new Config(this.data)\n    this._form = new Form(this.form, this.config)\n    this._view = new View(this._configurations)\n\n    this.validate = debounced(this._validate, this._configurations.debounceMs)\n\n    if (this._configurations.disableSubmitButtons) {\n      this._setupMutiationObserver()\n\n      if (!this.data.has(\"validated\")) this._initialCheck()\n    }\n\n    this.form.addEventListener(\"submit\", this._preventInvalidSubmission, true)\n    this.form.addEventListener(\"input\", this.validate, true)\n    this.form.addEventListener(\"valueUpdated\", this.validate, true)\n    this.form.addEventListener(\"blur\", this.recordVisit, true)\n  }\n\n  _removeEventListeners() {\n    this.mutationObserver && this.mutationObserver.disconnect()\n    this.form.removeEventListener(\n      \"submit\",\n      this._preventInvalidSubmission,\n      true\n    )\n    this.form.removeEventListener(\"valueUpdated\", this.validate, true)\n    this.form.removeEventListener(\"input\", this.validate, true)\n    this.form.removeEventListener(\"blur\", this.recordVisit, true)\n  }\n\n  _setupMutiationObserver() {\n    this.mutationObserver = new MutationObserver((mutationList) => {\n      const nodesNeedsValidation = this._nodesNeedsValidation(mutationList)\n\n      if (!nodesNeedsValidation.length) return\n\n      this._toggleSubmitButtons(this._form.isValid())\n\n      nodesNeedsValidation.forEach((el) => {\n        el.validate().catch(() => this._toggleSubmitButtons(false))\n      })\n    })\n\n    this.mutationObserver.observe(this.form, {\n      childList: true,\n      subtree: true,\n    })\n  }\n\n  _nodesNeedsValidation(mutationList) {\n    const nodesNeedsValidation = []\n\n    mutationList.forEach(({ addedNodes }) => {\n      if (!addedNodes) return\n      addedNodes.forEach((node) => {\n        if (\n          [\"select\", \"input\", \"textarea\"].includes(node.nodeName.toLowerCase())\n        ) {\n          const el = new Element(node, this.config)\n\n          if (el.willValidate) {\n            nodesNeedsValidation.push(el)\n          }\n        } else if (node.querySelector && node.querySelector(\"input, select\")) {\n          node.querySelectorAll(\"input, select\", \"textarea\").forEach((node) => {\n            const el = new Element(node, this.config)\n\n            if (el.willValidate) {\n              nodesNeedsValidation.push(el)\n            }\n          })\n        }\n      })\n    })\n\n    return nodesNeedsValidation\n  }\n\n  _preventInvalidSubmission = (event) => {\n    if (this._configurations.disableSubmitButtons) {\n      if (this._form.isValid()) return\n\n      event.stopImmediatePropagation()\n      event.stopPropagation()\n      event.preventDefault()\n\n      this._displayFormErrors()\n    }\n    const { submitter } = event\n    if (submitter.hasAttribute(\"data-validation-submitter\")) {\n      submitter.remove()\n      return\n    }\n\n    event.stopPropagation()\n    event.stopImmediatePropagation()\n    event.preventDefault()\n    if (this.validationInProgress) return\n    this.validationInProgress = true\n\n    this._form\n      .validate()\n      .then(() => {\n        this.validationInProgress = false\n        this._submitWithCustomSubmitter(submitter)\n      })\n      .catch((error) => {\n        if (error instanceof ValidationError) {\n          this.validationInProgress = false\n          this._displayFormErrors()\n        } else {\n          console.log(error)\n          throw error\n        }\n      })\n  }\n\n  get form() {\n    if (this.element.nodeName === \"FORM\") {\n      return this.element\n    } else {\n      return this.element.querySelector(\"form\")\n    }\n  }\n\n  async _initialCheck() {\n    this._form\n      .validate()\n      .then(() => this._toggleSubmitButtons(true))\n      .catch(() => this._toggleSubmitButtons(false))\n  }\n\n  _validate = async (event) => {\n    event.preventDefault()\n\n    let errorMessage\n    const { target } = event\n    const el = new Element(target, this.config)\n    const previousMessage = el.cachedErrorMessage\n\n    if (!el.willValidate) return\n\n    try {\n      await el.validate()\n\n      if (target.type === \"radio\") {\n        await this._form.validate().catch(() => {})\n      }\n    } catch (error) {\n      if (error instanceof ValidationError) {\n        errorMessage = error.message\n      } else {\n        throw error\n      }\n    }\n\n    this._toggleSubmitButtons(this._form.isValid())\n\n    this.display({ target, errorMessage, previousMessage, visited: el.visited })\n  }\n\n  _toggleSubmitButtons(bool) {\n    if (!this._configurations.disableSubmitButtons) return\n\n    this._form.submitButtons.forEach((submit) => {\n      submit.disabled = !bool\n    })\n  }\n\n  _focusFirstElement() {\n    if (!this._configurations.focusOnError) {\n      return\n    }\n\n    const element = this._form.elementsWithError[0]\n    element && element.raw.focus()\n  }\n\n  get _configurations() {\n    return this.config.configurations\n  }\n\n  _submitWithCustomSubmitter(originalSubmitter) {\n    const input = document.createElement(\"template\")\n    input.innerHTML = `\n      <input type=\"submit\" \n      style=\"display: none;\" \n      data-validation-submitter \n      name=\"${originalSubmitter.name}\" \n      value=\"${originalSubmitter.value}\" \n    />\n    `\n    this._form.raw.appendChild(input.content)\n\n    setTimeout(() => {\n      this._form.raw.querySelector(\"[data-validation-submitter]\").click()\n    })\n  }\n\n  _displayFormErrors() {\n    this._form.elements.forEach((element) => {\n      if (element.isInvalid()) {\n        element.visited = true\n        this.display({\n          target: element.raw,\n          errorMessage: element.cachedErrorMessage,\n          visited: true,\n        })\n      }\n    })\n\n    this._focusFirstElement()\n  }\n}\n\nimport { addValidator, config } from \"./config\"\n\nexport { addValidator, config, ValidationController }\n"],"names":["validators","configurations","debounceMs","focusOnError","disableSubmitButtons","containerSelector","errorMessageClass","errorMessagePosition","containerErrorClass","fieldErrorClass","locals","validationMap","badInput","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valueMissing","config","options","Object","assign","addValidator","name","func","addLocal","transalation","result","keys","forEach","validationClass","validationName","dataMap","key","has","get","parseInt","invalid","pattern","max","min","step","maxLength","minLength","required","el","errorMessage","_insertErrorMessageElement","errorElement","textContent","container","classList","add","dataset","errorDisplayed","remove","reset","insertAdjacentHTML","querySelector","_container","closest","Error","customMessageAttribute","ValidationError","message","constructor","errorType","Promise","resolve","reject","fieldValid","validity","valid","customMessage","defaultMessage","customValidationMessage","error","dataAttribute","errorTypes","index","length","customValidations","validates","all","split","map","validationMethod","method","currentLocal","replace","_","match","validInputTypes","node","raw","hasCacheErrorMessage","isInvalid","_errorMessage","removeCachedErrorMessage","cacheErrorMessage","validationMessageCache","removeAttribute","hasAttribute","Validator","bool","visited","nodeName","toLowerCase","includes","type","validationOn","validationOff","elementName","validatable","Form","elements","some","validate","_allElements","Element","filter","willValidate","Array","from","debounced","fn","wait","timeoutId","target","e","clearTimeout","setTimeout","ValidationController","_setup","_removeEventListeners","_validate","event","_configurations","_form","isValid","stopImmediatePropagation","stopPropagation","preventDefault","_displayFormErrors","submitter","validationInProgress","then","_submitWithCustomSubmitter","catch","console","log","previousMessage","cachedErrorMessage","_toggleSubmitButtons","display","_view","displayError","form","noValidate","Config","data","View","_setupMutiationObserver","_initialCheck","addEventListener","_preventInvalidSubmission","recordVisit","mutationObserver","disconnect","removeEventListener","MutationObserver","mutationList","nodesNeedsValidation","_nodesNeedsValidation","observe","childList","subtree","addedNodes","push","querySelectorAll","submitButtons","submit","disabled","element","elementsWithError","focus","originalSubmitter","input","document","createElement","innerHTML","value","appendChild","content","click","_focusFirstElement","Controller"],"mappings":"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"}